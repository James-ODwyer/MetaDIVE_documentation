<!DOCTYPE html>

<html lang="English" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Installation guide &#8212; MetaDIVE 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=80cc54d1"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Run setup" href="Run_setup.html" />
    <link rel="prev" title="MetaDIVE Overview" href="Overview.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="installation-guide">
<h1>Installation guide<a class="headerlink" href="#installation-guide" title="Link to this heading">¶</a></h1>
<section id="conda-installation">
<h2>Conda Installation<a class="headerlink" href="#conda-installation" title="Link to this heading">¶</a></h2>
<p>To use MetaDIVE, first install conda which is the software management system used:</p>
<p>To do this we need to pick a location to install miniconda and then download and unpack the program</p>
<p><strong>First</strong> we create a directory somewhere that can store large numbers of files (~10,000-50,000):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir<span class="w"> </span>/path/to/desired/directory/miniconda
</pre></div>
</div>
<p><strong>Next</strong> we download the latest version of miniconda:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>wget<span class="w"> </span>https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh<span class="w"> </span>-O<span class="w"> </span>/path/to/desired/directory/miniconda/miniconda.sh
</pre></div>
</div>
<p><strong>Then</strong> we unpack the download and install:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>bash<span class="w"> </span>/path/to/desired/directory/miniconda/miniconda.sh<span class="w"> </span>-b<span class="w"> </span>-u<span class="w"> </span>-p<span class="w"> </span>/path/to/desired/directory/miniconda/
</pre></div>
</div>
<p><strong>Then</strong> we activate the conda environment:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>/path/to/desired/directory/miniconda/bin/conda<span class="w"> </span>init<span class="w"> </span>bash
</pre></div>
</div>
<p><strong>Finally</strong> we close down the terminal and reopen the terminal so that the conda environment is ready.:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">exit</span>
</pre></div>
</div>
</section>
<section id="downloading-metadive">
<h2>Downloading MetaDIVE<a class="headerlink" href="#downloading-metadive" title="Link to this heading">¶</a></h2>
<p>(If conda is already installed you can skip to here)</p>
<p>As of July 2025 Conda requires you to accept the terms of service for different channels. To use conda we accept these terms</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda<span class="w"> </span>tos<span class="w"> </span>accept
</pre></div>
</div>
<p>Now that conda is available we need to <strong>download gitlfs</strong> to download MetaDIVE correctly</p>
<p>To do that we just use our new conda environment:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda<span class="w"> </span>install<span class="w"> </span>conda-forge::git-lfs<span class="w"> </span>-y
</pre></div>
</div>
<p>This will automatically install gitlfs through conda into your base conda environment
after it is finished downloading we need to activate gitlfs:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>lfs<span class="w"> </span>install
</pre></div>
</div>
<p>After installing and activating gitlfs we can download MetaDIVE. Create a folder where you would like to run the analysis.</p>
<p>The folder you download MetaDIVE into is where the analysis will take place. MetaDIVE will download into this folder as a subfolder called MetaDIVE:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir<span class="w"> </span>/path/to/where/you/want/to/run
<span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>/path/to/where/you/want/to/run
<span class="gp">$ </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/James-ODwyer/MetaDIVE.git
</pre></div>
</div>
<p>After you are finished copying MetaDIVE the folder structure will look like the following:</p>
<a class="reference internal image-reference" href="_images/MetaDIVE_first_folder.png"><img alt="MetaDIVE base folder after download" class="align-center" src="_images/MetaDIVE_first_folder.png" style="width: 600px;" />
</a>
<p>Note: the main folders in MetaDIVE are as follows</p>
<ol class="arabic simple">
<li><p><strong>databases</strong> which contains the location of where almost all databases MetaDIVE needs are. See :ref:` &lt;metadive-databases&gt;` for additional information on installing databases.</p></li>
<li><p><strong>envs</strong> which contains the location of the names of all software to be installed for MetaDIVE to run. See :ref:` &lt;metadive-environments&gt;` for additional information on installing databases.</p></li>
<li><p><strong>pipeline</strong> which contains the analysis scripts and rules for how MetaDIVE runs as well as the config file for changing metaDIVE settings. This is also where MetaDIVE will run and save outputs to.</p></li>
</ol>
</section>
<section id="building-metadive-scripts">
<h2>Building MetaDIVE scripts<a class="headerlink" href="#building-metadive-scripts" title="Link to this heading">¶</a></h2>
<p>MetaDIVE is made to work on bash HPC systems but there are a lot of different variables for how your HPC system may run.</p>
<p>The biggest is how your system batches and organises job submissions,</p>
<p>but there are also other aspects like whether your HPC lets you access the internet from a cluster, what partitions are used and even if an account code is required.</p>
<p>There are too many possibilities to cover them all here but MetaDIVE will attempt to update all scripts used to reflect your system with the below script located in the first folder of
the downloaded MetaDIVE git using &quot;setup_bash_scripts.sh&quot;. This file can be seen in the above image if you are unsure of where it is in the MetaDIVE folder.</p>
<p>The variables to know are batch-system where you specify what batch system your HPC uses &quot;PBS|SLURM|QSUB|LSF|SGE|CUSTOM&quot;.</p>
<p>partition where you specify how your HPC partitions their compute resources &quot;Any_value&quot; e.g., &quot;long|short|compute|data|&quot;.</p>
<p>download_partition where if a specific partition is required to access the internet and download objects give it here (this pipeline downloads host genomes dynamically from NCBI) &quot;download|io|any_other_value&quot;. Note if your system does not have a download specific node, give the value &quot;none&quot;</p>
<p>account where if you are required to give an account/project name to submitted job scripts &quot;labxyz|projectxyz|useridxyz|etc&quot;:</p>
<p>Finally, depending on how your system is set up you may have to specify nodes/ cpus per node and tasks per node or not have these variables at all. Either write 'yes' to include these as variables or 'no' to exclude them. This set up script has been tested extensively on different slurm systems but may be missing some variables for other batch systems so please let me know if you notice anything missing.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>MetaDIVE
<span class="gp">$ </span>bash<span class="w"> </span>setup_batch_headers.sh<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--batch-system<span class="w"> </span>SLURM<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--partition<span class="w"> </span>compute<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--download_partition<span class="w"> </span>io<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--account<span class="w"> </span>my_lab<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--nodes-supported<span class="w"> </span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--ntasks-per-node-supported<span class="w"> </span>no<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--cpus-per-task-supported<span class="w"> </span>yes
</pre></div>
</div>
</section>
<section id="metadive-environments">
<span id="id1"></span><h2>MetaDIVE environments<a class="headerlink" href="#metadive-environments" title="Link to this heading">¶</a></h2>
<p>All software required to run MetaDIVE is kept in conda environments but before MetaDIVE is run for the first time this software needs to be installed.</p>
<p>To do this all that is required is to run <strong>Create_conda_environments.sh</strong> located in the envs directory (MetaDIVE/envs).</p>
<p>This script will download all required software and install the correct conda environments for later use.</p>
<p>The script will take ~ 15 minutes to run but will only need to be done once regardless of how many times MetaDIVE is run.</p>
<p>Assuming you are in the MetaDive directory run the following script:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sbatch<span class="w"> </span>./envs/Create_conda_environments.sh
</pre></div>
</div>
</section>
<section id="metadive-databases">
<span id="id2"></span><h2>MetaDIVE databases<a class="headerlink" href="#metadive-databases" title="Link to this heading">¶</a></h2>
<p>MetaDIVE uses multiple databases, the majority of which are either unpacked from the zip files or are downloaded and built directly.</p>
<p>Two databases are assumed to be present on your HPC system already and are not downloaded and built as part of MetaDIVE, these are the Diamond dmnd and Blast nt databases.</p>
<p>These are often very large and it is recommended to use a single centrally located copy instead of installing multiple copies for every user.</p>
<p>To create all other databases all that is needed to do is run <strong>download_and_build_databases.sh</strong> located in the databases directory (MetaDIVE/databases)</p>
<p>The script will take ~ 90-180 minutes to run but will only need to be done once regardless of how many times MetaDIVE is run. I have tested this on a personal computer and it took 2.5 hours. Note, if you are keen to move on with the analysis of your data you can start your proper analysis analysis about an hour into the database script build time (while it is still building databases and still running) as the latter databases being built are used only ~1.5 hours into an analysis typically  will be ready by the time the pipeline reaches the required analysis step (some exceptions exist if you run samples with nearly no data as they may finish analysis in less than an hour total).</p>
<p>Assuming you are in the MetaDIVE directory run the following script:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sbatch<span class="w"> </span>./databases/download_and_build_databases.sh
</pre></div>
</div>
<p>After running this MetaDIVE is fully installed and can be run indefinitely.</p>
<p>Once completed you can move to setting up your MetaDIVE run.</p>
<p><a class="reference internal" href="Run_setup.html"><span class="doc">Next: Choosing Parameters</span></a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">MetaDIVE</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Overview.html">MetaDIVE Overview</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#conda-installation">Conda Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#downloading-metadive">Downloading MetaDIVE</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-metadive-scripts">Building MetaDIVE scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metadive-environments">MetaDIVE environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metadive-databases">MetaDIVE databases</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Run_setup.html">Run setup</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Results.html">Interpreting results</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Desc_envs.html">Detailed Conda environments used</a></li>
<li class="toctree-l1"><a class="reference internal" href="Desc_databases.html">Detailed databases information</a></li>
<li class="toctree-l1"><a class="reference internal" href="Desc_scripts.html">Detailed description of scripts files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Desc_rules.html">Detailed description of rules files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Troubleshooting.html">Common issues and troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="References.html">Software references</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="Overview.html" title="previous chapter">MetaDIVE Overview</a></li>
      <li>Next: <a href="Run_setup.html" title="next chapter">Run setup</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, James O'Dwyer.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/Installation_guide.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>